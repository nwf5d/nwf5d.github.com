<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="聂文峰" />
    <title>机器学习之－－感知机 | 聂文峰</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/feed/" rel="alternate" title="聂文峰" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css">
    <link rel="stylesheet" href="/media/css/highlight.css">
    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>机器学习之－－感知机</h1>
        </header>
        <nav>
        <span><a title="home page" class="" href="/">home</a></span>
        <span><a title="about" class="" href="/about/">about</a></span>
        <span><a title="publication" class="" href="/publication/">publication</a></span>
        <span><a title="guestbook" class="" href="/guestbook/">guestbook</a></span>
        <span><a title="vitae" class="" href="/vitae/">vitae</a></span>
        <span><a title="categories" class="" href="/categories/">categories</a></span>
        <span><a title="tags" class="" href="/tags/">tags</a></span>
        <span><a title="links" class="" href="/links/">links</a></span>
        <span><a title="subscribe by RSS" class="" href="/feed/">subscribe</a></span>
        </nav>
        <article class="content">
        <section class="post">
<p>感知机是二分类的线性分类模型，其输入是实例的特征向量，输出为实例的类别。
感知机学习的目的是将训练数据进行线性划分的分离超平面，属于是判别模型。感知机学习采用基于误分类的损失函数，利用梯度下降法对损失函数进行极小化，最后得到感知机模型。</p>

<p><em>强调：</em>利用感知机学习策略进行训练的数据集要求必须是线性可分的，否则感知机学习算法不会收敛，迭代结果会发生震荡。</p>

<h1>. <em>模型：</em> $f(x)=sign(w*x+b)$</h1>

<h1>. <em>学习策略：</em> $L(w,b)=-yi<em>(w</em>xi+b)$</h1>

<h1>. 学习算法：随机梯度下降</h1>

<p>$e<sup>x</sup> = \sum<em>{n=0}<sup>\infty</sup> \frac{x<sup>n}{n!}</sup> = \lim</em>{n\rightarrow\infty} (1+x/n)<sup>n$</sup></p>

<p>Python代码：</p>

<div class="highlight"><pre><code class="python"><span class="c"># -*- coding:gbk -*- </span>
<span class="c">#针对二维空间的感知机学习算法 </span>
<span class="c">#感知机模型 f(x) = sign(w*x+b) </span>
<span class="c">#学习策略 损失函数: L(w,b) = -y(w*x+b) </span>
<span class="c">#学习算法 随即梯度下降 </span>
<span class="c"># @author Richard</span>
<span class="c"># @date 2013-05-04</span>
<span class="c">#定义感知机类 </span>
<span class="k">class</span> <span class="nc">Perceptron</span>
    <span class="c">#初始化类 </span>
    <span class="c">#m_learnrate:学习率  m_w0:x0的权值  m_w1:x1的权值 m_b:常向量 </span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">m_learnrate</span><span class="p">,</span><span class="n">m_w0</span><span class="p">,</span><span class="n">m_w1</span><span class="p">,</span><span class="n">m_b</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_learnrate</span> <span class="o">=</span> <span class="n">m_learnrate</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span> <span class="o">=</span> <span class="n">m_w0</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span> <span class="o">=</span> <span class="n">m_w1</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_b</span> <span class="o">=</span> <span class="n">m_b</span> 

    <span class="c">#判断针对训练数据x，估测的模型与实际数据是否有误差 </span>
    <span class="c">#即判断损失函数L(w,b)是否为0 </span>
    <span class="k">def</span> <span class="nf">judgeHasError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span> 
        <span class="c">#如果表达式小于0，说明没有被正确分类 </span>
        <span class="c">#即y*(w0*x0+w1*x1+b)&lt;0 </span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">m_b</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">result</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span> 
            <span class="k">return</span> <span class="bp">False</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="bp">True</span> 

    <span class="c">#有误差的话，调整模型参数 </span>
    <span class="k">def</span> <span class="nf">adjustParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span> 
        <span class="c">#根据梯度下降法调整参数 </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_learnrate</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_learnrate</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">m_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_b</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_learnrate</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> 
        <span class="k">return</span> 

    <span class="c">#训练数据集 </span>
    <span class="k">def</span> <span class="nf">trainData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> 
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">isOver</span> <span class="o">=</span> <span class="bp">False</span> 
        <span class="k">while</span> <span class="ow">not</span> <span class="n">isOver</span><span class="p">:</span> 
            <span class="k">print</span> <span class="s">&quot;w0  w1  b :&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_b</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> 
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">judgeHasError</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> 
                    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">+</span><span class="mi">1</span> 
                    <span class="k">print</span> <span class="s">&quot;调整次数：&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">adjustParam</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> 
                    <span class="n">isOver</span> <span class="o">=</span> <span class="bp">False</span> 
                    <span class="k">break</span> 
                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">isOver</span> <span class="o">=</span> <span class="bp">True</span> 
        <span class="c">#打印最后的参数 </span>
        <span class="k">print</span> <span class="s">&quot;w0  w1  b :&quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w0</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_w1</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_b</span><span class="p">)</span> 

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span> 
    <span class="n">p</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
    <span class="c">#data = [[3,3,1],[4,3,1],[1,1,-1]] </span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> 
    <span class="n">p</span><span class="o">.</span><span class="n">trainData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> 
</code></pre>
</div>


<p>(完)</p>

<hr />

</section>
<section class="meta">
<span class="author">
  <a href="http://nwf5d.github.com">聂文峰</a>
</span>
<span class="time">
  /
  <time datetime="2013-05-04">2013-05-04</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#机器学习" title="机器学习">机器学习</a>&nbsp;
  
  <a href="/categories/#Working" title="Working">Working</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="/tags/#感知机" title="感知机">感知机</a>&nbsp;
  
  <a href="/tags/#机器学习" title="机器学习">机器学习</a>&nbsp;
  
</span>

</section>
<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'nwf5d'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = '/2012/11/do-a-good-job/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>



        </article>
      </div>
    </div>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1988641-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
