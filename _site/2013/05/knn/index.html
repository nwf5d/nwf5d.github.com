<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="聂文峰" />
    <title>机器学习之－－K近邻法 | 聂文峰</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/feed/" rel="alternate" title="聂文峰" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css">
    <link rel="stylesheet" href="/media/css/highlight.css">
    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>机器学习之－－K近邻法</h1>
        </header>
        <nav>
        <span><a title="home page" class="" href="/">home</a></span>
        <span><a title="about" class="" href="/about/">about</a></span>
        <span><a title="publication" class="" href="/publication/">publication</a></span>
        <span><a title="guestbook" class="" href="/guestbook/">guestbook</a></span>
        <span><a title="vitae" class="" href="/vitae/">vitae</a></span>
        <span><a title="categories" class="" href="/categories/">categories</a></span>
        <span><a title="tags" class="" href="/tags/">tags</a></span>
        <span><a title="links" class="" href="/links/">links</a></span>
        <span><a title="subscribe by RSS" class="" href="/feed/">subscribe</a></span>
        </nav>
        <article class="content">
        <section class="post">
<p>感知机是二分类的线性分类模型，其输入是实例的特征向量，输出为实例的类别。
感知机学习的目的是将训练数据进行线性划分的分离超平面，属于是判别模型。感知机学习采用基于误分类的损失函数，利用梯度下降法对损失函数进行极小化，最后得到感知机模型。</p>

<p>_强调：_利用感知机学习策略进行训练的数据集要求必须是线性可分的，否则感知机学习算法不会收敛，迭代结果会发生震荡。</p>

<h1 id="fxsignwxb">. <em>分类模型：</em> $f(x)=sign(w*x+b)$</h1>
<p>#. <em>极小化损失函数，对应于误分类点到分离超平面的总距离：</em>$\min<em>{w,b}L(w,b)=-\sum</em>{{x}<em>{i} \in M}{y}</em>{i}(w*{x}_{i}+b)$
#. 学习算法：随机梯度下降
#. 当训练集线性可分时，感知机学习算法是收敛的。其在训练集上的误分类次数k满足不等式：
$k \preceq ( \frac{R}{\gamma} )^2$</p>

<p>Python代码：</p>

<p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ {.python .numberLines}
# -<em>- coding:gbk -</em>- 
#针对二维空间的感知机学习算法 
#感知机模型 f(x) = sign(w<em>x+b) 
#学习策略 损失函数: L(w,b) = -y(w</em>x+b) 
#学习算法 随即梯度下降 
# @author Richard
# @date 2013-05-04
#定义感知机类 
class Perceptron
    #初始化类 
    #m_learnrate:学习率  m_w0:x0的权值  m_w1:x1的权值 m_b:常向量 
    def <strong>init</strong>(self,m_learnrate,m_w0,m_w1,m_b): 
        self.m_learnrate = m_learnrate 
        self.m_w0 = m_w0 
        self.m_w1 = m_w1 
        self.m_b = m_b </p>

<pre><code>#判断针对训练数据x，估测的模型与实际数据是否有误差 
#即判断损失函数L(w,b)是否为0 
def judgeHasError(self,x): 
    #如果表达式小于0，说明没有被正确分类 
    #即y*(w0*x0+w1*x1+b)&lt;0 
    result = x[2]*(x[0]*self.m_w0+x[1]*self.m_w1+self.m_b) 
    if result&lt;=0: 
        return False 
    else: 
        return True 

#有误差的话，调整模型参数 
def adjustParam(self,x): 
    #根据梯度下降法调整参数 
    self.m_w0 = self.m_w0 + self.m_learnrate*x[2]*x[0] 
    self.m_w1 = self.m_w1 + self.m_learnrate*x[2]*x[1] 
    self.m_b = self.m_b + self.m_learnrate*x[2] 
    return 

#训练数据集 
def trainData(self,data,num): 
    count = 0 
    isOver = False 
    while not isOver: 
        print "w0  w1  b :" +str(self.m_w0)+" "+str(self.m_w1)+" "+str(self.m_b) 
        for i in range(0,num): 
            if not self.judgeHasError(data[i]): 
                count = count+1 
                print "调整次数："+ str(count) 
                self.adjustParam(data[i]) 
                isOver = False 
                break 
            else: 
                isOver = True 
    #打印最后的参数 
    print "w0  w1  b :" +str(self.m_w0)+" "+str(self.m_w1)+" "+str(self.m_b) 
</code></pre>

<p>if <strong>name</strong> == ‘<strong>main</strong>’: 
    p = Perceptron(1,0,0,0) 
    #data = [[3,3,1],[4,3,1],[1,1,-1]] 
    data = [[3,3,1],[4,3,1],[1,1,-1],[2,2,-1],[5,4,1],[1,3,-1]] 
    p.trainData(data,6) 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>

<p>(完)</p>

<hr />

</section>
<section class="meta">
<span class="author">
  <a href="http://nwf5d.github.com">聂文峰</a>
</span>
<span class="time">
  /
  <time datetime="2013-05-08">2013-05-08</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#机器学习" title="机器学习">机器学习</a>&nbsp;
  
  <a href="/categories/#Working" title="Working">Working</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="/tags/#KNN" title="KNN">KNN</a>&nbsp;
  
  <a href="/tags/#机器学习" title="机器学习">机器学习</a>&nbsp;
  
</span>

</section>
<section class="comment">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'nwf5d'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = '/2013/05/perceptron/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = '/2013/10/resume/';
        
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>



        </article>
      </div>
    </div>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1988641-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
